<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
  <head>
    <title>RInfo Main REST Specification</title>
    <meta http-equiv="Content-Type" content="application/xhtml+xml;charset=utf-8" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <meta http-equiv="Content-Language" content="en" />
    <link rel="stylesheet" type="text/css" href="spec.css" />
  </head>
  <body>

    <h1>RInfo Main REST Specification</h1>
    <h2>Introduction</h2>
    <p>The Main RInfo Resource Service should follow the specs and guidelines in:</p>
    <ul>
      <li><a href="http://www.w3.org/TR/swbp-vocab-pub/"
          >Best Practice Recipes for Publishing RDF Vocabularies</a></li>
      <li><a href="http://www.w3.org/TR/cooluris/"
          >Cool URIs for the Semantic Web</a></li>
      <li><a href="http://www.w3.org/2001/tag/doc/alternatives-discovery.html"
          >On Linking Alternative Representations To Enable Discovery And Publishing</a></li>
      <li><a href="http://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html"
          >HTTP/1.1 Status Code Definitions</a></li>
    </ul>

    <p>The following definitions are implied:</p>
    <table>
      <thead>
        <tr><th>Keyword</th>
          <th>Action</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Define Namespaces and Base URL</td>
          <td class="act">XMLNS</td>
          <td class="arg">h</td>
          <td class="arg">http://www.w3.org/1999/xhtml</td>
        </tr>
        <tr><td></td>
          <td class="act">XMLNS</td>
          <td class="arg">atom</td>
          <td class="arg">http://www.w3.org/2005/Atom</td>
        </tr>
        <tr><td></td>
          <td class="act">XMLNS</td>
          <td class="arg">fh</td>
          <td class="arg">http://purl.org/syndication/history/1.0</td>
        </tr>
        <tr><td></td>
          <td class="act">Base URL</td>
          <td class="arg">${MAIN_URL}</td>
          <td class="arg"></td>
        </tr>
      </tbody>
    </table>

    <h2>Usage Examples</h2>

    <h3>Main Feed</h3>

    <p>Retrieving feeds follows this pattern:</p>
    <table>
      <thead>
        <tr><th>Keyword</th>
          <th>Action</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr><td>GET Atom Feed</td>
          <td class="act">[Arguments]</td>
          <td class="arg">${feed_url}</td>
          <td class="arg"></td>
        </tr>
        <tr><td></td>
          <td class="act">GET</td>
          <td class="arg">${feed_url}</td>
          <td class="arg"></td>
        </tr>
        <tr><td></td>
          <td class="act">Response</td>
          <td class="arg">200 OK</td>
          <td class="arg"></td>
        </tr>
        <tr><td></td>
          <td class="act">Header</td>
          <td class="arg">Content-Type</td>
          <td class="arg">application/atom+xml</td>
        </tr>
      </tbody>
    </table>

    <p>Retrieving the subscription and archive feed documents:</p>

    <table>
      <colgroup>
        <col width="20%" /> <col width="14%" />
        <col width="24%" /> <col width="24%" />
        <col width="18%" />
      </colgroup>
      <thead>
        <tr>
          <th>Test Case</th>
          <th>Action</th>
          <th></th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Subscription Feed</td>
          <td class="act">GET Atom Feed</td>
          <td class="arg">/feed/current</td>
          <td class="arg"></td>
          <td class="arg"></td>
        </tr>
        <tr><td></td>
          <td class="act">No XPath</td>
          <td class="arg">/atom:feed/fh:archive</td>
          <td class="arg"></td>
          <td class="arg"></td>
        </tr>
        <tr><td></td>
          <td class="arg">${prev_arch}=</td>
          <td class="act">XPath Regexp</td>
          <td class="arg">/atom:feed/atom:link[ @rel='prev-archive']/@href</td>
          <td class="arg">^/feed/.+/.+/T.+/.+Z$</td>
        </tr>
        <tr class="sep"><td>&#160;</td></tr>
        <tr><td></td>
          <td class="act">GET Atom Feed</td>
          <td class="arg">${prev_arch}</td>
          <td class="arg"></td>
          <td class="arg"></td>
        </tr>
        <tr><td></td>
          <td class="act">Find XPath</td>
          <td class="arg">/atom:feed/fh:archive</td>
          <td class="arg"></td>
          <td class="arg"></td>
        </tr>
        <tr><td></td>
          <td class="act">XPath Value</td>
          <td class="arg">/atom:feed/atom:link[ @rel='current']/@href</td>
          <td class="arg">/feed/current</td>
          <td class="arg"></td>
        </tr>
      </tbody>
    </table>

    <h3>Content Negotiation on Entries</h3>

    <p>Given the following usage pattern:</p>
    <table>
      <thead>
        <tr><th>Keyword</th>
          <th>Action</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Negotiate Entry Content</td>
          <td class="act">[Arguments]</td>
          <td class="arg">${entry_url}</td>
          <td class="arg">${media_type}</td>
        </tr>
        <tr><td></td>
          <td>...</td>
          <td class="arg">${language}</td>
          <td class="arg">${expected_location}</td>
        </tr>
        <tr><td></td>
          <td class="act">Should Not Be Equal</td>
          <td class="arg">${entry_url}</td>
          <td class="arg">${expected_location}</td>
        </tr>
        <tr><td></td>
          <td class="act">Set Header</td>
          <td class="arg">Accept</td>
          <td class="arg">${media_type}</td>
        </tr>
        <tr><td></td>
          <td class="act">GET</td>
          <td class="arg">${entry_url}</td>
          <td class="arg"></td>
        </tr>
        <tr><td></td>
          <td class="act">Response</td>
          <td class="arg">200 OK</td>
          <td class="arg"></td>
        </tr>
        <!-- TODO: Do we break Cool URIs and ConNeg if we don't require:
        <tr><td></td>
          <td class="act">Response</td>
          <td class="arg">302 Found</td>
          <td class="arg"></td>
        </tr>
        <tr><td></td>
          <td class="act">Follow</td>
          <td class="arg"></td>
          <td class="arg"></td>
        </tr>
        -->
        <tr><td></td>
          <td class="act">Header</td>
          <td class="arg">Content-Type</td>
          <td class="arg">${media_type}</td>
        </tr>
        <tr><td></td>
          <td class="act">Header</td>
          <td class="arg">Content-Language</td>
          <td class="arg">${language}</td>
        </tr>
        <tr><td></td>
          <td class="act">Header</td>
          <td class="arg">Content-Location</td>
          <td class="arg">${expected_location}</td>
        </tr>
        <tr><td></td>
          <td class="act">Header</td>
          <td class="arg">Vary</td>
          <td class="arg">Accept-Charset, Accept-Encoding, Accept-Language, Accept</td>
        </tr>
      </tbody>
    </table>

    <p>These representations are to be expected:</p>
    <table>
      <colgroup>
        <col width="20%" /> <col width="20%" />
        <col width="30%" /> <col width="30%" />
      </colgroup>
      <thead>
        <tr>
          <th>Test Case</th>
          <th>Action</th>
          <th></th>
          <th></th>
        </tr>
      </thead>
      <tbody>

        <tr><td>RDF Content of Entry</td>
          <td class="act">Negotiate Entry Content</td>
          <td class="arg">/publ/sfs/1999:175</td>
          <td class="arg">application/rdf+xml</td>
        </tr>
        <tr><td></td>
          <td>...</td>
          <td class="arg"></td>
          <td class="arg">/publ/sfs/1999:175/rdf</td>
        </tr>

        <tr class="sep"><td>&#160;</td></tr>

        <tr><td>PDF Content of Entry</td>
          <td class="act">Set Header</td>
          <td class="arg">Accept-Language</td>
          <td class="arg">sv</td>
        </tr>
        <tr><td></td>
          <td class="act">Negotiate Entry Content</td>
          <td class="arg">/publ/sfs/1999:175</td>
          <td class="arg">application/pdf</td>
        </tr>
        <tr><td></td>
          <td>...</td>
          <td class="arg">sv</td>
          <td class="arg">/publ/sfs/1999:175/pdf</td>
        </tr>

      </tbody>
    </table>

    <h2>Execution</h2>
    <p>These definitions make this document runnable with the
      <a href="http://robotframework.org/">Robot Framework</a>.
    </p>
    <table>
      <thead>
        <tr><th>Setting</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr><td>Library</td>
          <td>robotlib/RestLibrary.py</td>
        </tr>
        <tr><td>Test Setup</td>
          <td>Define Namespaces and Base URL</td>
        </tr>
      </tbody>
    </table>

    <table>
      <thead>
        <tr><th>Variable</th>
          <th>Value</th>
        </tr>
      </thead>
      <tbody>
        <tr><td class="arg">${MAIN_URL}</td>
          <td class="arg">http://rinfo-main.statskontoret.se:8080/</td>
        </tr>
      </tbody>
    </table>

  </body>
</html>
